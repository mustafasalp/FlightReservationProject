<div *ngIf="logoutMessage" class="logout-message">
  <mat-icon>logout</mat-icon>
  {{ logoutMessage }}
</div>

<!-- HERO SECTION -->
<div class="hero-section">
  <div class="hero-content">

    <!-- HERO TEXT -->
    <div class="hero-text">
      <h1>Discover Your Next <span class="highlight">Adventure</span></h1>
      <p>Experience premium travel with our exclusive flight selection. Comfort, speed, and luxury await.</p>
    </div>

    <!-- SEARCH CONTAINER -->
    <div class="search-container">
      <div class="search-form">

        <!-- FROM -->
        <mat-form-field appearance="outline" class="custom-field">
          <mat-label>From</mat-label>
          <mat-select [(ngModel)]="searchModel.from">
            <mat-option [value]="null">Any</mat-option>
            <mat-option *ngFor="let city of origins" [value]="city">{{ city }}</mat-option>
          </mat-select>
          <mat-icon matPrefix>flight_takeoff</mat-icon>
        </mat-form-field>

        <!-- TO -->
        <mat-form-field appearance="outline" class="custom-field">
          <mat-label>To</mat-label>
          <mat-select [(ngModel)]="searchModel.to">
            <mat-option [value]="null">Any</mat-option>
            <mat-option *ngFor="let city of destinations" [value]="city">{{ city }}</mat-option>
          </mat-select>
          <mat-icon matPrefix>flight_land</mat-icon>
        </mat-form-field>

        <!-- DATE -->
        <mat-form-field appearance="outline" class="custom-field">
          <mat-label>Date</mat-label>
          <input matInput [matDatepicker]="picker" [(ngModel)]="searchModel.date" placeholder="Choose a date">
          <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>

        <!-- SEARCH BUTTON -->
        <button class="btn-search" (click)="onSearch()" [disabled]="loading">
          <span *ngIf="!loading">Search Flights</span>
          <span *ngIf="loading">Searching...</span>
        </button>

      </div>
    </div>

  </div>
</div>

<!-- RESULTS (Moved above auth section) -->
<div class="results-section" *ngIf="flights.length > 0">
  <div class="container">
    <h2>Available Flights</h2>

    <div class="flights-list">
      <div class="flight-card-horizontal" *ngFor="let flight of flights">

        <!-- 1. AIRLINE INFO (Left) -->
        <div class="section airline-section">
          <img [src]="flight.logoUrl" [alt]="flight.airline" class="airline-logo" *ngIf="flight.logoUrl">
          <span class="airline-name">{{ flight.airline }}</span>
        </div>

        <!-- 2. ROUTE INFO (Middle) -->
        <div class="section route-section">
          <!-- Departure -->
          <div class="route-point">
            <span class="time">{{ flight.departureTime | date:'HH:mm' }}</span>
            <span class="code">{{ getAirportCode(flight.origin) }}</span>
            <span class="city">{{ flight.origin }}</span>
          </div>

          <!-- Duration / Graphic -->
          <div class="route-graphic">
            <span class="flight-date">{{ flight.departureTime | date:'d MMM y' }}</span>
            <span class="duration">{{ flight.duration || '2h 15m' }}</span>
            <div class="flight-line">
              <span class="dot"></span>
              <span class="line"></span>
              <mat-icon>flight</mat-icon>
              <span class="line"></span>
              <span class="dot"></span>
            </div>
            <span class="type">Direct</span>
          </div>

          <!-- Arrival -->
          <div class="route-point">
            <span class="time">{{ flight.arrivalTime | date:'HH:mm' }}</span>
            <span class="code">{{ getAirportCode(flight.destination) }}</span>
            <span class="city">{{ flight.destination }}</span>
          </div>
        </div>

        <!-- 3. PRICE INFO -->
        <div class="section price-section">
          <!-- Business -->
          <div class="price-tag business" *ngIf="flight.businessPrice">
            <span class="lbl">Business</span>
            <div class="price-row">
              <span class="currency">$</span>
              <span class="amount">{{ flight.businessPrice }}</span>
            </div>
          </div>

          <!-- Economy -->
          <div class="price-tag economy">
            <span class="lbl">Economy</span>
            <div class="price-row">
              <span class="currency">$</span>
              <span class="amount">{{ flight.basePrice }}</span>
            </div>
          </div>
        </div>

        <!-- 4. ACTION BUTTON -->
        <div class="section action-section">
          <button class="btn-book" (click)="onBook(flight.id)" [disabled]="isPast(flight.departureTime)"
            [class.disabled]="isPast(flight.departureTime)">
            {{ isPast(flight.departureTime) ? 'Past' : 'Select' }}
            <mat-icon>chevron_right</mat-icon>
          </button>
        </div>

      </div>
    </div>

  </div>
</div>

<!-- AUTH SECTION -->
<div class="auth-wrapper">

  <!-- Not Logged In -->
  <div class="auth-box" *ngIf="!auth.isLoggedIn()">
    <h2>Welcome to FlightReserve</h2>
    <p>Login or create an account to book your flights.</p>

    <button class="btn primary" (click)="goToLogin()">Login</button>
    <button class="btn secondary" (click)="goToRegister()">Register</button>
  </div>

  <!-- Logged In (User) -->
  <div class="auth-box" *ngIf="auth.isLoggedIn() && !auth.isAdmin()">
    <h2>Hello {{ auth.getUserName() }} ðŸ‘‹</h2>
    <p>View your reservations anytime.</p>

    <button class="btn primary" (click)="goToMyReservations()">My Reservations</button>
  </div>

  <!-- Logged In (Admin Only) -->
  <div class="auth-box" *ngIf="auth.isLoggedIn() && auth.isAdmin()">
    <h2>Admin Panel</h2>
    <p>Manage flights and reservations.</p>

    <button class="btn primary" (click)="goToAdmin()">Go to Admin Dashboard</button>
  </div>

</div>

<!-- AIRLINE TICKER -->
<div class="airlines-ticker">
  <h3>Trusted by World's Best Airlines</h3>

  <div class="ticker-track">
    <!-- COPY 1 -->
    <div class="airline-logo" *ngFor="let airline of airlines">
      <a [href]="airline.websiteUrl" target="_blank">
        <img [src]="airline.logoUrl" [alt]="airline.name">
      </a>
    </div>

    <!-- COPY 2 (scroll) -->
    <div class="airline-logo" *ngFor="let airline of airlines">
      <a [href]="airline.websiteUrl" target="_blank">
        <img [src]="airline.logoUrl" [alt]="airline.name">
      </a>
    </div>
  </div>
</div>